var t=Object.defineProperty,e=(e,s,a)=>((e,s,a)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[s]=a)(e,"symbol"!=typeof s?s+"":s,a);import{p as s}from"./phaser-DM0uoNMb.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class a extends s.Scene{constructor(){super("Boot")}preload(){this.load.image("background","assets/Background/Green.png")}create(){this.scene.start("Preloader")}}const i=1008,r=48,o=32,n="bgMusic",l="button",h="debrisHit",d="enemyHit",c="gmOver",p="platform",m="unstablePlatform",y="debris",u="enemy",f="playerIdle",g="playerRun",b="playerJump",w="playerFall";class v{constructor(t,s,a,i,r){e(this,"platform"),this.platform=t.physics.add.staticGroup(),this.platform.create(s+24,a+24,i,r),this.platform.create(s+72,a+24,i,r),this.platform.create(s+120,a+24,i,r),this.platform.create(s+168,a+24,i,r)}}const k={platformPositions:[0,816,408],getRandomPlatformX:function(){const t=Math.floor(Math.random()*this.platformPositions.length);return this.platformPositions[t]}};class x{constructor(t){e(this,"debrisGroup"),this.debrisGroup=t.physics.add.group()}spawnDebris(t,e,s){const a=this.debrisGroup.create(e,s,y);a.setGravityY(Phaser.Math.Between(200,400)),a.setVelocityX(Phaser.Math.Between(-50,50)),a.setAngularVelocity(Phaser.Math.Between(-100,100)),a.setBounce(0),a.setCollideWorldBounds(!1),a.allowGravity=!0}}class P{constructor(t,s,a,i){e(this,"player"),this.player=t.physics.add.sprite(s,a,i),t.anims.create({key:f,frames:t.anims.generateFrameNumbers(f,{start:0,end:10}),frameRate:10,repeat:-1}),t.anims.create({key:g,frames:t.anims.generateFrameNumbers(g,{start:0,end:11}),frameRate:10,repeat:-1}),t.anims.create({key:b,frames:t.anims.generateFrameNumbers(b,{start:0,end:0}),frameRate:10,repeat:-1}),t.anims.create({key:w,frames:t.anims.generateFrameNumbers(w,{start:0,end:0}),frameRate:10,repeat:-1})}}class S{constructor(t,s,a,o,n){e(this,"platform"),this.platform=t.physics.add.staticGroup();for(let e=0,l=0;e<i;e+=r,l++)this.platform.create(s+r*l+24,a+24,o,n)}}class B{constructor(t,s,a,i,r){e(this,"platform"),e(this,"isShaking",!1),this.platform=t.physics.add.group({allowGravity:!1,immovable:!0}),this.platform.children.iterate((t=>(t.body.setGravityY(300),!0))),this.platform.create(s+24,a+24,i,r),this.platform.create(s+72,a+24,i,r),this.platform.create(s+120,a+24,i,r),this.platform.create(s+168,a+24,i,r)}}class C{constructor(t,s,a){e(this,"enemy",null),e(this,"direction"),this.enemy=t.physics.add.sprite(s,a,u),this.enemy.setGravityY(0),this.enemy.setVelocityX(100),this.enemy.setCollideWorldBounds(!0),this.enemy.setBounce(1,0),t.textures.exists(u)?(t.anims.exists("spin")||t.anims.create({key:"spin",frames:t.anims.generateFrameNumbers(u,{start:0,end:7}),frameRate:10,repeat:-1}),this.enemy.play("spin")):console.error("Enemy texture not found!"),this.direction=1}update(){this.enemy&&(this.enemy.setVelocityY(0),(this.enemy.body.blocked.left||this.enemy.body.blocked.right)&&(this.direction*=-1,this.enemy.setVelocityX(100*this.direction)))}}class M extends s.Scene{constructor(){super("Game"),e(this,"camera"),e(this,"background"),e(this,"msg_text"),e(this,"platformSpawnHeight",192),e(this,"player"),e(this,"platforms",[]),e(this,"debrisManager"),e(this,"cursor"),e(this,"escKey"),e(this,"enemies",[])}create(){var t,e;this.camera=this.cameras.main,this.add.image(0,0,"background").setOrigin(0,0).setDisplaySize(this.scale.width,this.scale.height),this.spawnPlayer();let s=new S(this,0,720,p,2);this.platforms.push(s),this.physics.add.collider(this.player.player,s.platform),this.spawnPlatforms(),this.spawnPlatforms(),this.spawnPlatforms(),this.spawnPlatforms(),this.debrisManager=new x(this),this.input.keyboard&&(this.escKey=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.ESC)),this.time.addEvent({delay:2e3,callback:()=>{const t=Phaser.Math.Between(100,908);this.debrisManager.spawnDebris(this,t,0),this.physics.add.collider(this.player.player,this.debrisManager.debrisGroup,(()=>{this.sound.add(h).play(),this.scene.start("GameOver")}))},loop:!0}),this.cursor=null==(e=null==(t=this.input)?void 0:t.keyboard)?void 0:e.createCursorKeys(),this.spawnEnemies(),this.enemies.forEach((t=>{t.enemy&&this.platforms.forEach((e=>{this.physics.add.collider(t.enemy,e.platform)})),this.physics.add.collider(this.player.player,t.enemy,(()=>{this.sound.add(d).play(),this.scene.start("GameOver")}))}))}update(t,e){var s,a,i,r,o,n,l,h;(null==(s=this.cursor)?void 0:s.left.isDown)?(this.player.player.setVelocityX(-160),this.player.player.flipX=!0,this.player.player.anims.play(g,!0)):(null==(a=this.cursor)?void 0:a.right.isDown)?(this.player.player.setVelocityX(160),this.player.player.flipX=!1,this.player.player.anims.play(g,!0)):this.player.player.setVelocityX(0),(null==(i=this.cursor)?void 0:i.up.isDown)&&(null==(r=this.player.player.body)?void 0:r.touching.down)&&(this.player.player.setVelocityY(-330),this.player.player.anims.play(b,!0)),Phaser.Input.Keyboard.JustDown(this.escKey)&&window.location.reload(),((null==(o=this.player.player.body)?void 0:o.velocity.y)??0)>0&&this.player.player.anims.play(w,!0),((null==(n=this.player.player.body)?void 0:n.velocity.y)??0)<0&&this.player.player.anims.play(b,!0),0==((null==(l=this.player.player.body)?void 0:l.velocity.x)??0)&&0==((null==(h=this.player.player.body)?void 0:h.velocity.y)??0)&&this.player.player.anims.play(f,!0),this.enemies.forEach((t=>t.update()))}spawnPlatforms(){const t=k.getRandomPlatformX(),e=Math.random()<.5?new v(this,t,this.platformSpawnHeight,p,2):new B(this,t,this.platformSpawnHeight,m,0);this.platforms.push(e),this.physics.add.collider(this.player.player,e.platform,(()=>{e instanceof B&&!1===e.isShaking&&(e.isShaking=!0,e.platform.children.iterate((t=>(this.tweens.add({targets:t,x:"+=5",duration:50,ease:"Sine.easeInOut",repeat:10,yoyo:!0,onComplete:()=>{e.platform.children.iterate((t=>(t.body.setImmovable(!1),t.body.setVelocityY(300),!0)))}}),!0))))}));let s=k.getRandomPlatformX();for(;s===t;)s=k.getRandomPlatformX();const a=Math.random()<.5?new v(this,s,this.platformSpawnHeight,p,2):new B(this,s,this.platformSpawnHeight,m,0);this.platforms.push(a),this.physics.add.collider(this.player.player,a.platform,(()=>{a instanceof B&&!1===a.isShaking&&(a.isShaking=!0,a.platform.children.iterate((t=>(this.tweens.add({targets:t,x:"+=5",duration:50,ease:"Sine.easeInOut",repeat:10,yoyo:!0,onComplete:()=>{a.platform.children.iterate((t=>(t.body.setImmovable(!1),t.body.setVelocityY(300),!0)))}}),!0))))})),this.platformSpawnHeight+=144}spawnPlayer(){this.player=new P(this,504,672,f),this.player.player.anims.play(f)}spawnEnemies(){this.platforms.forEach((t=>{if(Math.random()<.2){const e=t.platform.getChildren()[0],s=new C(this,e.x,e.y-r);this.enemies.push(s)}}))}}class O extends s.Scene{constructor(){super("GameOver"),e(this,"camera"),e(this,"gameover_text"),e(this,"mainButton"),e(this,"exitButton")}create(){const t=this.sound.get(n);t&&t.isPlaying&&t.stop();let e=this.sound.get(c);e||(e=this.sound.add(c,{loop:!0,volume:.7})),e.isPlaying||e.play(),this.camera=this.cameras.main,this.camera.setBackgroundColor(16711680),this.gameover_text=this.add.text(512,384,"Game Over",{fontFamily:"Arial Black",fontSize:64,color:"#ffffff",stroke:"#000000",strokeThickness:8,align:"center"}),this.gameover_text.setOrigin(.5),this.mainButton=this.add.text(this.scale.width/2,600,"Main Menu",{fontFamily:"Verdana",fontSize:36,color:"#ffffff",backgroundColor:"#000000",padding:{x:30,y:15},align:"center"}).setOrigin(.5).setInteractive({useHandCursor:!0}),this.mainButton.on("pointerdown",(()=>{window.location.reload()})),this.exitButton=this.add.text(this.scale.width/2,700,"Exit",{fontFamily:"Verdana",fontSize:36,color:"#ffffff",backgroundColor:"#000000",padding:{x:30,y:15},align:"center"}).setOrigin(.5).setInteractive({useHandCursor:!0}),this.exitButton.on("pointerdown",(()=>{window.close()})),[this.mainButton,this.exitButton].forEach((t=>{t.on("pointerover",(()=>t.setStyle({backgroundColor:"#942222"}))),t.on("pointerout",(()=>t.setStyle({backgroundColor:(this.mainButton,"#000000")})))}))}}class H extends s.Scene{constructor(){super("MainMenu"),e(this,"background"),e(this,"logo"),e(this,"title"),e(this,"startButton"),e(this,"exitButton"),e(this,"music")}create(){let t=this.sound.get(n);t?t.isPlaying||t.play():(t=this.sound.add(n,{loop:!0,volume:.5}),t.play()),this.add.image(0,0,"background").setOrigin(0,0).setDisplaySize(this.scale.width,this.scale.height),this.logo=this.add.image(this.scale.width/2,250,"logo"),this.title=this.add.text(this.scale.width/2,500,"Main Menu",{fontFamily:"Papyrus, fantasy",fontSize:50,color:"#2ecc71",stroke:"#000000",strokeThickness:6,shadow:{offsetX:4,offsetY:4,color:"#000000",blur:4,fill:!0},align:"center"}).setOrigin(.5),this.startButton=this.add.text(this.scale.width/2,600,"Start Game",{fontFamily:"Verdana",fontSize:36,color:"#ffffff",backgroundColor:"#007700",padding:{x:30,y:15},align:"center"}).setOrigin(.5).setInteractive({useHandCursor:!0}),this.startButton.on("pointerdown",(()=>{this.sound.add(l).play(),this.scene.start("Game")})),this.exitButton=this.add.text(this.scale.width/2,700,"Exit",{fontFamily:"Verdana",fontSize:36,color:"#ffffff",backgroundColor:"#005500",padding:{x:30,y:15},align:"center"}).setOrigin(.5).setInteractive({useHandCursor:!0}),this.exitButton.on("pointerdown",(()=>{window.close()})),[this.startButton,this.exitButton].forEach((t=>{t.on("pointerover",(()=>t.setStyle({backgroundColor:"#009900"}))),t.on("pointerout",(()=>t.setStyle({backgroundColor:t===this.startButton?"#007700":"#005500"})))}))}}class G extends s.Scene{constructor(){super("Preloader")}init(){this.add.image(0,0,"background").setOrigin(0,0).setDisplaySize(this.scale.width,this.scale.height),this.add.rectangle(this.scale.width/2,this.scale.height/2,468,32).setStrokeStyle(1,16777215);const t=this.add.rectangle(this.scale.width/2-230,this.scale.height/2,4,28,16777215);this.load.on("progress",(e=>{t.width=4+460*e}))}preload(){this.load.setPath("assets"),this.load.image("logo","EcoTowerLogo.png"),this.load.spritesheet(p,"Platforms/Terrain.png",{frameWidth:r,frameHeight:r}),this.load.spritesheet(m,"Platforms/UnstableTerrain.png",{frameWidth:r,frameHeight:r}),this.load.image(y,"Platforms/Rock Head/Idle.png"),this.load.spritesheet(u,"Platforms/Saw/On (38x38).png",{frameWidth:38,frameHeight:38}),this.load.spritesheet(f,"Character/Ninja_Frog/Idle.png",{frameWidth:o,frameHeight:o}),this.load.spritesheet(g,"Character/Ninja_Frog/Run.png",{frameWidth:o,frameHeight:o}),this.load.spritesheet(b,"Character/Ninja_Frog/Jump.png",{frameWidth:o,frameHeight:o}),this.load.spritesheet(w,"Character/Ninja_Frog/Fall.png",{frameWidth:o,frameHeight:o}),this.load.audio(n,"Audio/GameMusic.mp3"),this.load.audio(l,"Audio/button.mp3"),this.load.audio(h,"Audio/debrisHit.mp3"),this.load.audio(d,"Audio/enemyHit.mp3"),this.load.audio("playerJump","Audio/playerJump.mp3"),this.load.audio("run","Audio/run.mp3"),this.load.audio(c,"Audio/gameOver.mp3")}create(){this.scene.start("MainMenu")}}const F={type:Phaser.AUTO,width:i,height:768,parent:"game-container",backgroundColor:"#028af8",scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{gravity:{x:0,y:300},debug:!0}},scene:[a,G,H,M,O]};new s.Game(F);
